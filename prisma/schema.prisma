generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  // provider = "sqlite"
}

model User {
  id             String   @id @default(uuid())
  ea_id          String   @unique
  name           String
  username       String?  @unique
  password       String?
  role           Role     @default(USER)
  avatar         String?
  bio            String?
  rank           Ranks    @default(RECRUTA)
  trackergg_link String?
  platform       Platform
  stats          Json?
  status         Status   @default(PENDING)
  createdAt      DateTime @default(now())
  
  userInvites         Invite[]
  userMedals         UserMedal[]
}

model Medal {
  id          String   @id @default(uuid())
  name        String
  description String
  rarity      Rarity   @default(COMMON)
  image       String?
  createdAt   DateTime @default(now())

  userMedals UserMedal[]
}

model UserMedal {
  id        String   @id @default(uuid())
  user_id   String
  medal_id  String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [user_id], references: [id], onDelete: Cascade)
  medal     Medal    @relation(fields: [medal_id], references: [id], onDelete: Cascade)
}

model Invite {
  id        String    @id @default(uuid())
  user_id   String
  token     String    @unique
  expiresAt DateTime
  used      Boolean   @default(false)
  createdAt DateTime  @default(now())
  usedAt    DateTime?
  
  user      User      @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

enum Platform {
  PC
  PLAYSTATION
  XBOX
}

enum Role {
  ADMIN
  USER
}

enum Ranks {
  RECRUTA
  SOLDADO
  CABO
  SARGENTO
  TENENTE
  CAPITAO
  MAJOR
  CORONEL
  GENERAL
}

enum Status {
  ACTIVE
  INACTIVE
  PENDING
  BANNED
}

enum Rarity {
  COMMON
  RARE
  EPIC
  LEGENDARY
  UNIQUE
}